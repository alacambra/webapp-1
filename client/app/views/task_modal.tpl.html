<div>
	<div class="modal-header">
		<button type="button" class="close" ng-click="close()">&times;</button>
		<h4 class="modal-title">{{ modal.title }}</h4>
	</div>
	<div class="modal-body">
		<form name="form.task" class="form-horizontal" role="form" novalidate="">

			<!-- Title -->
			<div class="form-group">
				<label for="titleInput" class="col-sm-3 control-label">Title</label>

				<div class="col-sm-9">
					<input name="title"
						   ng-model="modal.task.title"
						   pp-model=""
						   type="text"
						   class="form-control"
						   id="titleInput"
						   placeholder="Title"
						   ng-minlength="3"
						   ng-maxlength="50"
						   required="">
				</div>
				<div class="error col-sm-9 col-sm-offset-3" ng-if="form.task.title.$dirty && form.task.title.$invalid">
					<small class="error" ng-show="form.task.title.$error.required">Project title is required.</small>
					<small class="error" ng-show="form.task.title.$error.minlength">Project title is required to be at least 3 characters.</small>
					<small class="error" ng-show="form.task.title.$error.maxlength">Project title can't be longer than 50 characters.</small>
				</div>
			</div>

			<!-- Description -->
			<div class="form-group">
				<label for="descriptionInput" class="col-sm-3 control-label">
					<span>Description</span>
					<br/>
					<small ng-show="form.task.description.$viewValue" ng-class="{ error: form.task.description.$viewValue.length > 3000 }">
						<span>({{ form.task.description.$viewValue.length }}/3000)</span>
					</small>
				</label>
				<div class="col-sm-9">
					<textarea name="description"
							  ng-model="modal.task.description"
							  rows="3"
							  class="form-control"
							  id="descriptionInput"
							  placeholder="Description"
							  ng-maxlength="3000"></textarea> 
				</div>
				<div class="error col-sm-9 col-sm-offset-3" ng-if="form.task.description.$dirty && form.task.description.$invalid">
					<small class="error" ng-show="form.task.description.$error.maxlength">Project description can't be longer than 3000 characters.</small>
				</div>
			</div>

			<!-- Assignee -->
			<div class="form-group">
				<label for="assigneeInput" class="col-sm-3 control-label">Assignee</label>
				
				<div class="col-sm-5">
					<select name="assignee"
							ng-model="modal.task.assignee"
							ng-init = "modal.assignableUsers[0] = modal.task.assignee"
							class="form-control"
							id="assigneeInput"
							ng-options="user as user.getPrettyName() for user in modal.assignableUsers track by user.id"
							required=""></select>
				</div>
				<div class="error col-sm-9 col-sm-offset-3" ng-if="form.task.assignee.$dirty && form.task.assignee.$invalid">
					<small class="error" ng-show="form.task.assignee.$error.required">An Assignee is required.</small>
				</div>
			</div>
			<!-- Project -->
			<div class="form-group">
				<label for="projectInput" class="col-sm-3 control-label">Project</label>
				<div class="col-sm-5">
					<select name="project"
							ng-model="modal.task.project"
							ng-init = "modal.assignableProjects[0] = modal.task.project"
							class="form-control"
							id="projectInput"
							ng-options="project as project.title for project in modal.assignableProjects track by project.id"
							ng-disabled="modal.disabled.project"></select>
				</div>
			</div>

			<!-- Status -->
			<div class="form-group">
				<label for="statusInput" class="col-sm-3 control-label">Status</label>

				<div class="col-sm-5">
					<select name="status"
							ng-model="modal.task.status"
							class="form-control"
							id="statusInput"
							ng-options="key as status for (key, status) in modal.task.getStatusList()"></select>
				</div>
			</div>

			<!-- Prio -->
			<div class="form-group">
				<label for="prioInput" class="col-sm-3 control-label">Priority</label>

				<div class="col-sm-5">
					<select name="priority"
							ng-model="modal.task.priority"
							class="form-control"
							id="prioInput"
							ng-options="key as priority for (key, priority) in modal.task.getPriorityList()"></select>
				</div>
			</div>

			<!-- Start -->
			<div class="form-group">
				<label for="startDateInput" class="col-sm-3 control-label">Start Date</label>

				<div class="col-sm-5 input-group">
					<input name="startDate"
						   ng-model="modal.task.startDate"
						   pp-convert-date="dd.MM.yyyy"
						   class="form-control"
						   id="startDateInput"
						   datepicker-popup="dd.MM.yyyy"
						   min="'1900-01-01'"
						   max="modal.task.endDate"
						   disabled="disabled"
						   is-open="modal.datepicker.startDate">
					<span class="input-group-btn">
						<button class="btn btn-default" ng-click="openDatePicker($event, 'startDate')">
							<i class="glyphicon glyphicon-calendar"></i>
						</button>
					</span>
				</div>
			</div>

			<!-- End -->
			<div class="form-group">
				<label for="endDateInput" class="col-sm-3 control-label">End Date</label>

				<div class="col-sm-5 input-group">
					<input name="endDate"
						   ng-model="modal.task.endDate"
						   pp-convert-date="dd.MM.yyyy"
						   class="form-control"
						   id="endDateInput"
						   datepicker-popup="dd.MM.yyyy"
						   min="modal.task.startDate"
						   max="'2100-01-01'"
						   disabled="disabled"
						   is-open="modal.datepicker.endDate">
					<span class="input-group-btn">
						<button class="btn btn-default" ng-click="openDatePicker($event, 'endDate')">
							<i class="glyphicon glyphicon-calendar"></i>
						</button>
					</span>
				</div>
			</div>

			<!-- Duration -->
			<div class="form-group">
				<label for="durationInput" class="col-sm-3 control-label">Duration</label>

				<div class="col-sm-5 input-group">
					<input name="duration"
						   ng-model="modal.task.duration"
						   pp-model=""
						   pp-convert-time=""
						   type="text"
						   class="form-control text-right"
						   id="durationInput"
						   placeholder="Duration">
					<span class="input-group-addon">hours</span>
				</div>
			</div>

			<!-- Effort -->
			<div class="form-group">
				<label for="effortInput" class="col-sm-3 control-label">Effort</label>

				<div class="col-sm-5 input-group">
					<input name="effort"
						   ng-model="modal.task.effort"
						   pp-model=""
						   pp-convert-time=""
						   type="text"
						   class="form-control text-right"
						   id="effortInput"
						   placeholder="Effort">
					<span class="input-group-addon">hours</span>
				</div>
			</div>

			<!-- Progress -->
			<div class="form-group">
				<label for="progressInput" class="col-sm-3 control-label">Progress</label>

				<div class="col-sm-5 input-group">
					<input name="progress"
						   ng-model="modal.task.progress"
						   pp-model=""
						   pp-convert-percent=""
						   type="number"
						   class="form-control text-right"
						   id="progressInput"
						   placeholder="Progress">
					<span class="input-group-addon">%</span>
				</div>
			</div>

		</form>
	</div>
	<div class="modal-body" ng-controller="LogCtrl" ng-if="modal.task.id" ng-init="idObject = modal.task.id" ng-include="'views/changelog.tpl.html'"></div>
	<div class="modal-footer">
		<div class="text-center" ng-loading="taskModal.save">
			<img src="images/load_indicator.gif" alt="" style="padding:10px 0px 20px" />
		</div>
		<button type="button" class="btn btn-default" ng-click="close()">Abbrechen</button>
		<button type="button" class="btn btn-primary" ng-click="save()">Speichern und Schlie√üen</button>
		<div class="loader" ng-show="modal.loader.model.save"></div>
		<p class="error text-left" ng-show="error">{{ error }}</p>
	</div>
</div>